`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.81it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.37it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Some weights of PegasusForConditionalGeneration were not initialized from the model checkpoint at /home/wenhesun/.cache/huggingface/hub/models--tuner007--pegasus_paraphrase and are newly initialized: ['model.encoder.embed_positions.weight', 'model.decoder.embed_positions.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Original Candidate:	  a photo of an astronaut riding a horse on mars
Original Score:	  50.0
Current Iteration:  1
Base Candidate:  a photo of an astronaut riding a horse on mars
Base Score:  50.0
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.37it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.9547853376716375
['a photo']
Error occurs (parser) and skip this mutation 2
[]
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.25it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.7687154458835721
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Error occurs (parser) and skip this mutation 1
Candidate:

Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.07it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.745579251088202
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.73it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  1.1807163478806615
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.73it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  1.4886975986883044
['a photo']
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
Candidate:  a photo
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.62it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  1.4542903052642941
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1

Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.65it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.56it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  1.310577243566513
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
[]
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.37it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:389: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `1.5` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Candidate Score:  0.6043893750756979
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
[]
[]
Error occurs (parser) and skip this mutation 2
Candidate:  of an astronaut riding There is a horse on mars
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.78it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  14.067530632019043
['a photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.58it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.6134491879492998
Top N Candidates of Current Iteration:  ['a photo of an astronaut riding a horse on mars', 'of an astronaut riding There is a horse on mars', '', 'a photo', '', '', '', '', '', '']
Result Candidate:  a photo of an astronaut riding a horse on mars
Result Score:  50.0
Current Iteration:  2
Base Candidate:  a photo of an astronaut riding a horse on mars
Base Score:  50.0
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
[]
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.49it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.6094744428992271
[]
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.00it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.9239245671778917
[]
Error occurs (parser) and skip this mutation 2
[]
[]
Error occurs (parser) and skip this mutation 2
[]
[]
Error occurs (parser) and skip this mutation 1
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.30it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.7690675556659698
['of an astronaut riding']
[]
['photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
Candidate:  That's about it an astronaut riding
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  12.961538136005402
['a']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
['photo']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
[]
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.72it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.7384883239865303
[]
Error occurs (parser) and skip this mutation 1
[]
Error occurs (parser) and skip this mutation 2
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
['is a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.42it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.7300505647435784
[]
Error occurs (parser) and skip this mutation 2
[]
Error occurs (parser) and skip this mutation 1
['of an astronaut riding a horse on mars']
Error occurs (parser) and skip this mutation 2
['is a horse on mars']
Error occurs (parser) and skip this mutation 2
[]
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.08it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.33it/s]
Traceback (most recent call last):
  File "/home/wenhesun/Plum/pic_score_main.py", line 78, in <module>
    main(args)
  File "/home/wenhesun/Plum/pic_score_main.py", line 22, in main
    trainer.train(instruction, chosen_task_name="pic_score", args = args)
  File "/home/wenhesun/Plum/trainers/HS_trainer.py", line 248, in train
    w_m_score = self.score(w_m, c+1, args=args)
  File "/home/wenhesun/Plum/trainers/Pic_HS_trainer.py", line 134, in score
    sd_pipe = sd_pipe.to("cuda")
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/pipelines/pipeline_utils.py", line 869, in to
    module.to(device, dtype)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/transformers/modeling_utils.py", line 2460, in to
    return super().to(*args, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 927, in to
    return self._apply(convert)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 579, in _apply
    module._apply(fn)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 579, in _apply
    module._apply(fn)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 579, in _apply
    module._apply(fn)
  [Previous line repeated 3 more times]
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 602, in _apply
    param_applied = fn(param)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 925, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
KeyboardInterrupt