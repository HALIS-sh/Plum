`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.41it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.39it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Some weights of PegasusForConditionalGeneration were not initialized from the model checkpoint at /home/wenhesun/.cache/huggingface/hub/models--tuner007--pegasus_paraphrase and are newly initialized: ['model.decoder.embed_positions.weight', 'model.encoder.embed_positions.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Original Candidate:	  a photo of an astronaut riding a horse on mars
Original Score:	  50.0
Current Iteration:  1
Base Candidate:  a photo of an astronaut riding a horse on mars
Base Score:  50.0
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.23it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.999676575884223
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.92it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.51it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.7359972922131419
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.33it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:389: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `1.5` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Candidate Score:  0.65120505169034
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  of an astronaut There is a person riding a horse on mars
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.53it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  37.804585695266724
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.84it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.39it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  47.39826172590256
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  of an astronaut riding a horse on mars
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.49it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  71.03980481624603
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  a A photo of something of an astronaut Someone is riding a horse on mars
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.80it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  18.627242743968964
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.90it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  1.147744944319129
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  of an astronaut riding a horse on mars
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.59it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  50.870439410209656
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  a photo
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.65it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  0.5468342395033687
Top N Candidates of Current Iteration:  ['of an astronaut riding a horse on mars', 'of an astronaut riding a horse on mars', 'a photo of an astronaut riding a horse on mars', 'a photo of an astronaut riding a horse on mars', 'of an astronaut There is a person riding a horse on mars', 'a A photo of something of an astronaut Someone is riding a horse on mars', '', '', '', '']
Result Candidate:  of an astronaut riding a horse on mars
Result Score:  71.03980481624603
Current Iteration:  2
Base Candidate:  of an astronaut riding a horse on mars
Base Score:  71.03980481624603
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.31it/s]
Token indices sequence length is longer than the specified maximum sequence length for this model (93 > 77). Running this sequence through the model will result in indexing errors
The following part of your input was truncated because CLIP can only handle sequences up to 77 tokens: ["horse on mars she is she is a woman.'on the planet mars '"]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
The following part of your input was truncated because CLIP can only handle sequences up to 77 tokens: ["horse on mars she is she is a woman.'on the planet mars '"]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.4039836931042373
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  The way you can obtain success is by never quitting"' Success can be achieved by never giving up."
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.85it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  0.4838677356019616
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.24it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  3.638860024511814
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.18it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.3140247077681124
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.37it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.9724682662636042
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Candidate:  of
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.88it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  0.5437016952782869
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.72it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  0.2550469944253564
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.45it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:  17%|█████████████████▌                                                                                       | 1/6 [00:00<00:02,  1.77it/s]
Candidate Score:  32.056641578674316
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.48it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:   0%|                                                                                                                 | 0/6 [00:00<?, ?it/s]
Candidate Score:  1.3409259961917996
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Error occurs (parser) and skip this mutation
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.34it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]








100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Exception in thread ChkStopThr:
Traceback (most recent call last):
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/threading.py", line 973, in _bootstrap_inner
Exception in thread NetStatThr:
    self.run()
Traceback (most recent call last):
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/threading.py", line 910, in run
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/threading.py", line 973, in _bootstrap_inner
    self._target(*self._args, **self._kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 170, in check_status
    status_response = self._interface.communicate_stop_status()
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 127, in communicate_stop_status
    self.run()
    resp = self._communicate_stop_status(status)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/threading.py", line 910, in run
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 395, in _communicate_stop_status
    self._target(*self._args, **self._kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 152, in check_network_status
    resp = self._communicate(req, local=True)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 226, in _communicate
    status_response = self._interface.communicate_network_status()
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 138, in communicate_network_status
    resp = self._communicate_network_status(status)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 405, in _communicate_network_status
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 231, in _communicate_async
    resp = self._communicate(req, local=True)
    raise Exception("The wandb backend process has shutdown")
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 226, in _communicate
Exception: The wandb backend process has shutdown
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 231, in _communicate_async
    raise Exception("The wandb backend process has shutdown")
Exception: The wandb backend process has shutdown
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.22it/s]
  4%|█████▍                                                                                                                                  | 2/50 [00:00<00:14,  3.32it/s]
Traceback (most recent call last):
  File "/home/wenhesun/Plum/pic_score_main.py", line 78, in <module>
    main(args)
  File "/home/wenhesun/Plum/pic_score_main.py", line 22, in main
    trainer.train(instruction, chosen_task_name="pic_score", args = args)
  File "/home/wenhesun/Plum/trainers/HS_trainer.py", line 241, in train
  File "/home/wenhesun/Plum/trainers/Pic_HS_trainer.py", line 141, in score
    image = sd_pipe(prompt).images[0]
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/pipelines/stable_diffusion/pipeline_stable_diffusion.py", line 1002, in __call__
    noise_pred = self.unet(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/unet_2d_condition.py", line 1177, in forward
    sample = upsample_block(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/unet_2d_blocks.py", line 2354, in forward
    hidden_states = attn(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/transformer_2d.py", line 392, in forward
    hidden_states = block(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/attention.py", line 366, in forward
    attn_output = self.attn2(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py", line 527, in forward
    return self.processor(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py", line 760, in __call__
    query = attn.to_q(hidden_states, *args)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/lora.py", line 430, in forward
    out = super().forward(hidden_states)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt