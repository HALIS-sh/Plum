`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.

Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.10it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.38it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Some weights of PegasusForConditionalGeneration were not initialized from the model checkpoint at /home/wenhesun/.cache/huggingface/hub/models--tuner007--pegasus_paraphrase and are newly initialized: ['model.decoder.embed_positions.weight', 'model.encoder.embed_positions.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Original Candidate:	  a photo of an astronaut riding a horse on mars
Original Score:	  50.0
Current Iteration:  1
Base Candidate:  a photo of an astronaut riding a horse on mars
Base Score:  50.0
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:00<00:00,  6.11it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:389: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `1.5` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Candidate Score:  0.639949063770473
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 1
Error occurs (parser) and skip this mutation 2
Candidate:  of An individual who is an individual who is an individual who is an individual who is an individual who is an individual that is an individual that is an individual that is an individual that is an individual that is an individual that is an individual that is an individual that is an individual that is an individual riding a horse on mars
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.94it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  49.52879324555397
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.34it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Candidate Score:  0.48588895006105304
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 2
Error occurs (parser) and skip this mutation 1
Candidate:
Loading pipeline components...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.74it/s]






100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]







100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:14<00:00,  3.55it/s]
Loading pipeline components...:  17%|█████████████████▌                                                                                       | 1/6 [00:00<00:04,  1.15it/s]
Traceback (most recent call last):
  File "/home/wenhesun/Plum/pic_score_main.py", line 78, in <module>
    main(args)
  File "/home/wenhesun/Plum/pic_score_main.py", line 22, in main
    trainer.train(instruction, chosen_task_name="pic_score", args = args)
  File "/home/wenhesun/Plum/trainers/HS_trainer.py", line 247, in train
    w_m_score = self.score(w_m, c+1, args=args)
  File "/home/wenhesun/Plum/trainers/Pic_HS_trainer.py", line 132, in score
    sd_pipe = StableDiffusionPipeline.from_pretrained("/home/wenhesun/.cache/huggingface/hub/models--stabilityai--stable-diffusion-2-1/snapshots/5cae40e6a2745ae2b01ad92ae5043f95f23644d6", torch_dtype=torch.float16)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/pipelines/pipeline_utils.py", line 1271, in from_pretrained
    loaded_sub_model = load_sub_model(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/pipelines/pipeline_utils.py", line 525, in load_sub_model
    loaded_sub_model = load_method(os.path.join(cached_folder, name), **loading_kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/huggingface_hub/utils/_validators.py", line 118, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/modeling_utils.py", line 812, in from_pretrained
    unexpected_keys = load_model_dict_into_meta(
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/diffusers/models/modeling_utils.py", line 159, in load_model_dict_into_meta
    set_module_tensor_to_device(model, param_name, device, value=param, dtype=dtype)
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/accelerate/utils/modeling.py", line 398, in set_module_tensor_to_device
    torch.cuda.empty_cache()
  File "/home/wenhesun/anaconda3/envs/stable-diffusion/lib/python3.9/site-packages/torch/cuda/memory.py", line 121, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt